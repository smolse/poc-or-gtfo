import pyarrow.flight as flight


class StdoutFlightServer(flight.FlightServerBase):
    def __init__(self, location ):
        super().__init__(
            location,
            tls_certificates=[
                (open("server_crt.pem", "rb").read(), open("server_key.pem", "rb").read())
            ]
        )

    def do_put(self, context, descriptor, reader, writer):
        reader.read_all()


if __name__ == "__main__":
    location = flight.Location.for_grpc_tls("0.0.0.0", 5005)
    server = StdoutFlightServer(location)
    server.serve()
